(function(){"use strict";var n,t,e,r,s,c,o,u,i,a=[].slice;n=jQuery,t=function(n){return n.toLowerCase().replace(/(?:^|\W)\w/g,function(n){return n.toUpperCase()})},i={none:function(n){return n},capitalize:t,uppercase:function(n){return n.toUpperCase()},lowercase:function(n){return n.toLowerCase()}},o=function(n){var t,e;switch(e=n.split(" "),t=e[0]){case"overline":return function(n){return{height:0,thickness:n/12}};case"line-through":return function(n){return{height:n/2,thickness:n/20}};case"underline":return function(n){return{height:n,thickness:n/12}};case"none":return function(){return{height:0,thickness:0}}}},u=function(n){var t,e,r,s,c,o;return"none"===n?null:(o=n.split(" "),e=4<=o.length?a.call(o,0,c=o.length-3):(c=0,[]),r=o[c++],s=o[c++],t=o[c++],{blur:parseInt(t,10),v_shadow:parseInt(s,10),h_shadow:parseInt(r,10),color:e.join(" ")})},c=function(t,e){var r,s,c;return s=n("<span></span>"),s.text(t),s.css("font",e),n(document.documentElement).append(s),r=s.height(),c=s.width(),s.remove(),{height:r,width:c}},e=function(n,t,e,r,s,a,l,h){var f,d,p;return t=i[l](t),h=u(h),p=c(t,e),n.attr(p),f=n[0].getContext("2d"),f.save(),f.fillStyle=s,f.font=e,f.textAlign="left",f.textBaseline="top",h&&(f.shadowBlur=h.blur,f.shadowOffsetY=h.v_shadow,f.shadowOffsetX=h.h_shadow,f.shadowColor=h.color),f.fillText(t,0,0),f.restore(),d=o(a)(r),0!==d.thickness&&(f.beginPath(),f.strokeStyle=s,f.lineWidth=d.thickness,f.moveTo(0,d.height),f.lineTo(p.width,d.height),f.stroke(),f.restore()),n},r=function(n,t,r,s){return e(t,r+"@"+s,n.css("font"),parseInt(n.css("font-size"),10),n.css("color"),n.css("text-decoration"),n.css("text-transform"),n.css("text-shadow"))},s=function(n,t,e){var r,s,c,o,u,i,a,l,h,f,d;return i="mailto:"+n+"@"+t,o=function(){var n,t,r,s;for(r=e.cc_users,s=[],u=n=0,t=r.length;t>n;u=++n)h=r[u],s.push(h+"@"+e.cc_domains[u]);return s}().join(","),s=function(){var n,t,r,s;for(r=e.bcc_users,s=[],u=n=0,t=r.length;t>n;u=++n)h=r[u],s.push(h+"@"+e.bcc_domains[u]);return s}().join(","),l=encodeURI(null!=(f=e.subject)?f:""),c=encodeURI(null!=(d=e.body)?d:""),a=[],o&&a.push("cc="+o),s&&a.push("bcc="+s),l&&a.push("subject="+l),c&&a.push("body="+c),r=a.join("&"),r&&(i=i+"?"+r),i},n.fn.canvas_mail=function(t,e,c){return null==c&&(c={}),null==c.cc_users&&(c.cc_users=[]),null==c.cc_domains&&(c.cc_domains=[]),null==c.bcc_users&&(c.bcc_users=[]),null==c.bcc_domains&&(c.bcc_domains=[]),this.each(function(){var o,u;return o=n(this),u=n("<canvas></canvas>"),u.css("vertical-align","text-top"),r(o,u,t,e),o.empty(),o.append(u),"A"===o.prop("tagName")?(o.mouseover(function(){return n(this).attr("href",s(t,e,c)),r(o,u,t,e)}),o.mouseout(function(){return n(this).attr("href",null),r(o,u,t,e)})):void 0})},n.fn.link_mail=function(t,e,r){return null==r&&(r={}),null==r.cc_users&&(r.cc_users=[]),null==r.cc_domains&&(r.cc_domains=[]),null==r.bcc_users&&(r.bcc_users=[]),null==r.bcc_domains&&(r.bcc_domains=[]),this.each(function(){var c;return c=n(this),"A"===c.prop("tagName")?(c.mouseover(function(){return n(this).attr("href",s(t,e,r))}),c.mouseout(function(){return n(this).attr("href",null)})):void 0})}}).call(this);